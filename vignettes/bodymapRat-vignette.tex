%\VignetteIndexEntry{The bodymapRat data user's guide}
%\VignettePackage{bodymapRat}
%\VignetteEngine{knitr::knitr}
\documentclass{article}\usepackage[]{graphicx}\usepackage[usenames,dvipsnames]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}

\RequirePackage{/Library/Frameworks/R.framework/Versions/3.2/Resources/library/BiocStyle/resources/tex/Bioconductor}

\AtBeginDocument{\bibliographystyle{/Library/Frameworks/R.framework/Versions/3.2/Resources/library/BiocStyle/resources/tex/unsrturl}}


\setlength{\parskip}{1\baselineskip}
\setlength{\parindent}{0pt}

\title{The \texttt{bodymapRat} data user's guide}
\author{Stephanie C. Hicks \texttt{shicks@jimmy.harvard.edu} \and
Kwame Okrah \texttt{kwame.okrah@gmail.com} }

\date{Modified: July 23, 2015.  Compiled: \today}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\maketitle



\section{Overview}


The \texttt{bodymapRat} package contains gene expression data on 652 RNA-Seq samples from a
comprehensive rat transcriptomic BodyMap study. These samples include the sequence
identifier information provided in the header of the FASTQ files which can be used
as a surrogate for batch. These samples have not been normalized or pre-processed.

The data are an \texttt{ExpressionSet}. The phenotypic information can be extracted
using the \texttt{pData()} function and a description is listed in Table
\ref{tab:description}.

\begin{table}[h]
\caption{Description of phenotypic data in the \texttt{bodymapRat} ExpressionSet. }
\begin{center}
\begin{tabular}{|c|c|}
\hline
Title & Description \\
\hline
sraExperiment & SRA Experiment ID\\
title & Title of sample provided by the authors \\
geoAccession & GEO Accession ID\\
BioSample & BioSample ID\\
avgLength & Average read length \\
instrument & Machine identifier (from FASTQ header) \\
runID & Run ID (from FASTQ header) \\
fcID & Flow cell ID (from FASTQ header) \\
fcLane & Flow cell lane (from FASTQ header) \\
tile & Tile (from FASTQ header)\\
xtile & xtile (from FASTQ header) \\
ytile & ytile (from FASTQ header)\\
organ & Body organ \\
sex & Gender \\
stage & Stage \\
techRep & Technical replicate number \\
colOrgan & Column of colors to help with plotting \\
rnaRIN & RIN number \\
barcode & barcode number\\
\hline
\end{tabular}
\end{center}
\label{tab:description}
\end{table}%


The data can be accessed as follows:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(Biobase)}
\hlkwd{library}\hlstd{(useful)}
\hlkwd{library}\hlstd{(bodymapRat)}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{data}\hlstd{(bodymapRat)}

\hlcom{# Get the expression data}
\hlstd{edata} \hlkwb{=} \hlkwd{exprs}\hlstd{(bodymapRat)}
\hlkwd{corner}\hlstd{(edata)}
\end{alltt}
\begin{verbatim}
##                    SRR1169893 SRR1169894 SRR1169895 SRR1169896 SRR1169897
## ENSRNOG00000000001          1          0          0          1          4
## ENSRNOG00000000007          1          1          0          3          0
## ENSRNOG00000000008          7          4          2          3          7
## ENSRNOG00000000009          0          0          0          0          1
## ENSRNOG00000000010          0          1          0          0          0
\end{verbatim}
\begin{alltt}
\hlcom{# Get the pheno data}
\hlstd{pdata} \hlkwb{=} \hlkwd{pData}\hlstd{(bodymapRat)}
\hlkwd{head}\hlstd{(pdata)}
\end{alltt}
\begin{verbatim}
##            sraExperiment     sraRun       title geoAccession sraSample    BioSample
## SRR1169893     SRX471368 SRR1169893 Adr_F_002_1   GSM1328469 SRS558114 SAMN02642886
## SRR1169894     SRX471368 SRR1169894 Adr_F_002_1   GSM1328469 SRS558114 SAMN02642886
## SRR1169895     SRX471369 SRR1169895 Adr_F_002_2   GSM1328470 SRS558115 SAMN02642867
## SRR1169896     SRX471369 SRR1169896 Adr_F_002_2   GSM1328470 SRS558115 SAMN02642867
## SRR1169897     SRX471370 SRR1169897 Adr_F_002_3   GSM1328471 SRS558116 SAMN02642894
## SRR1169898     SRX471370 SRR1169898 Adr_F_002_3   GSM1328471 SRS558116 SAMN02642894
##            avgLength   organ sex stage techRep colOrgan mix rnaRIN barcode instrument
## SRR1169893        50 Adrenal   F     2       1    brown  M1    9.3      11  HWI-ST845
## SRR1169894        50 Adrenal   F     2       2    brown  M1    9.3      11  HWI-ST845
## SRR1169895        50 Adrenal   F     2       1    brown  M1    9.1       5  HWI-ST845
## SRR1169896        50 Adrenal   F     2       2    brown  M1    9.1       5  HWI-ST845
## SRR1169897        50 Adrenal   F     2       1    brown  M1    9.5       3 HWI-ST1131
## SRR1169898        50 Adrenal   F     2       2    brown  M1    9.5       3 HWI-ST1195
##             runID      fcID fcLane tile xtile ytile
## SRR1169893 120326 D0VTJACXX      2 1101  1506  2000
## SRR1169894 120525 D10G7ACXX      2 1101  1394  2133
## SRR1169895 120326 D0VTJACXX      5 1101  1170  2029
## SRR1169896 120525 D10G7ACXX      5 1101  1650  2126
## SRR1169897 120424 C0P4UACXX      4 1101  1675  2216
## SRR1169898 120525 C0TDUACXX      4 1101  1138  2067
\end{verbatim}
\end{kframe}
\end{knitrout}

The data in this package are used as an example data set in the \texttt{qsmooth}
package.

\section{References}

\begin{enumerate}

\item Yu et al. (2013). A rat RNA-Seq transcriptomic BodyMap across 11 organs
and 4 developmental stages. \textit{Nature Communications} \textbf{5}:3230.
PMID: 24510058. PMCID: PMC3926002.


\end{enumerate}
\section{SessionInfo}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{sessionInfo}\hlstd{()}
\end{alltt}
\begin{verbatim}
## R version 3.2.0 (2015-04-16)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X 10.10.4 (Yosemite)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
## [1] bodymapRat_0.0.1    useful_1.1.8        ggplot2_1.0.1       Biobase_2.29.1     
## [5] BiocGenerics_0.15.2 knitr_1.10.5       
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.11.6      digest_0.6.8     MASS_7.3-40      grid_3.2.0       plyr_1.8.3      
##  [6] gtable_0.1.2     formatR_1.2      magrittr_1.5     scales_0.2.5     evaluate_0.7    
## [11] highr_0.5        stringi_0.5-4    reshape2_1.4.1   proto_0.3-10     BiocStyle_1.7.4 
## [16] tools_3.2.0      stringr_1.0.0    munsell_0.4.2    colorspace_1.2-6
\end{verbatim}
\end{kframe}
\end{knitrout}





\end{document}
